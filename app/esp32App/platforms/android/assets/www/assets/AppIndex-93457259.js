import{_ as S,o as m,c as k,a as n,w as l,E as x,b as I,d as g,e as _,f,g as v,h as A,i as w,j as E,k as u,l as N,m as T,n as V,p as B,q as D}from"./index-63eb6c0e.js";const M={name:"Manager",props:{userId:String,tableData:Array},data(){return{}},methods:{}};function O(t,e,o,i,a,s){const c=x,r=I;return m(),k("div",null,[n(r,{data:o.tableData,style:{width:"100%"}},{default:l(()=>[n(c,{prop:"user",label:"用户",width:"180"})]),_:1},8,["data"])])}const b=S(M,[["render",O]]);const L={name:"Home",props:{userId:String,homeForm:Object},data(){return{}},methods:{onChange(t){this.$emit("changeSwitch",t)},testConnection(){this.$emit("testButton")}}};function W(t,e,o,i,a,s){const c=v,r=A,d=w,p=E;return m(),k("div",null,[n(p,{ref:"homeForm",model:o.homeForm,"label-width":"120px"},{default:l(()=>[n(d,{label:"服务器链接状态"},{default:l(()=>[n(c,{modelValue:o.homeForm.connectionStatus,"onUpdate:modelValue":e[0]||(e[0]=h=>o.homeForm.connectionStatus=h),"active-color":"#13ce66","inactive-color":"#ff4949",disabled:"disabled"},null,8,["modelValue"]),n(r,{onClick:s.testConnection},{default:l(()=>[g("测试连接")]),_:1},8,["onClick"])]),_:1}),o.homeForm.connectionStatus?(m(),_(d,{key:0,label:"锁状态"},{default:l(()=>[n(c,{modelValue:o.homeForm.lockState,"onUpdate:modelValue":e[1]||(e[1]=h=>o.homeForm.lockState=h),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:s.onChange},null,8,["modelValue","onChange"])]),_:1})):f("",!0)]),_:1},8,["model"])])}const C=S(L,[["render",W]]);const H={name:"AppIndex",components:{Home:C,Manager:b},data(){return{homeForm:{connectionStatus:!1,lockState:!1},activeIndex:"1",tableData:[{user:"王小虎"},{user:"王小虎"}],hostAddress:"",keyId:"123123"}},mounted(){this.$refs.box.addEventListener("deviceready",()=>{this.onDeviceReady()}),this.getConnectionStatus()},created(){},methods:{testConnection(){this.getConnectionStatus()},onDeviceReady(){this.$refs.box.addEventListener("online",()=>{this.getConnectionStatus()})},handleSelect(t,e){this.activeIndex=t},connectionTest(){u.get("http://"+this.hostAddress+"/inline").then(t=>{alert("通信测试"+JSON.stringify(t)),t&&t.data==="works"?(this.homeForm.connectionStatus=!0,this.getLockState()):this.homeForm.connectionStatus=!1},t=>{this.homeForm.connectionStatus=!1})},getUserList(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/getAiImage",t).then(e=>{console.log(e)})},getLockState(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/getAiImage",t).then(e=>{console.log(e),alert("获取锁状态"+JSON.stringify(e)),e&&e.data?this.homeForm.lockState=!0:this.homeForm.lockState=!1})},getConnectionStatus(){this.isConnectWifi()},isConnectWifi(){navigator.connection.type===Connection.WIFI?networkinterface.getWiFiIPAddress(e=>{this.hostAddress=this.getNetAddress(e.ip,e.subnet),this.connectionTest()}):alert("请连接WIFI")},getNetAddress(t,e){let o="",i=t.split("."),a=e.split("."),s=Number(i[2]),c=Number(i[3]),r=Number(a[2]),d=Number(a[3]);return o=(s&r)+"."+((c&d)+1),o=i[0]+"."+i[1]+"."+o,o},doOpen(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/open",t).then(e=>{console.log(e),alert("开："+JSON.stringify(e)),e&&e.data==="open"&&(this.homeForm.lockState=!0)})},doClose(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/close",t).then(e=>{console.log(e),alert("关："+JSON.stringify(e)),e&&e.data==="close"&&(this.homeForm.lockState=!1)})},onChangeSwitch(t){alert("更改状态："+t),t?this.doOpen():this.doClose()}},watch:{activeIndex(t,e){}}},J={ref:"box"};function P(t,e,o,i,a,s){const c=T,r=V,d=B,p=C,h=b,y=D,F=N;return m(),k("div",J,[n(F,null,{default:l(()=>[n(d,null,{default:l(()=>[n(r,{"default-active":a.activeIndex,class:"el-menu-demo",mode:"horizontal",onSelect:s.handleSelect,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},{default:l(()=>[n(c,{index:"1"},{default:l(()=>[g("我的家")]),_:1}),a.homeForm.connectionStatus?(m(),_(c,{key:0,index:"2"},{default:l(()=>[g("管理员页面")]),_:1})):f("",!0)]),_:1},8,["default-active","onSelect"])]),_:1}),n(y,null,{default:l(()=>[a.activeIndex==="1"?(m(),_(p,{key:0,homeForm:a.homeForm,onChangeSwitch:s.onChangeSwitch,onTestButton:s.testConnection},null,8,["homeForm","onChangeSwitch","onTestButton"])):f("",!0),a.activeIndex==="2"?(m(),_(h,{key:1,tableData:a.tableData},null,8,["tableData"])):f("",!0)]),_:1})]),_:1})],512)}const j=S(H,[["render",P]]);export{j as default};
