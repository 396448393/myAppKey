import{_ as k,o as m,c as S,a as n,w as s,E as I,b as v,d as g,e as _,f as p,g as y,h as A,i as w,j as E,k as u,l as T,m as N,n as V,p as B,q as D}from"./index-4d30ad2c.js";const M={name:"Manager",props:{userId:String,tableData:Array},data(){return{}},methods:{}};function L(t,e,o,i,a,l){const c=I,r=v;return m(),S("div",null,[n(r,{data:o.tableData,style:{width:"100%"}},{default:s(()=>[n(c,{prop:"user",label:"用户",width:"180"})]),_:1},8,["data"])])}const b=k(M,[["render",L]]);const W={name:"Home",props:{userId:String,homeForm:Object},data(){return{}},methods:{onChange(t){this.$emit("changeSwitch",t)},testConnection(){this.$emit("testButton")}}};function H(t,e,o,i,a,l){const c=y,r=A,d=w,f=E;return m(),S("div",null,[n(f,{ref:"homeForm",model:o.homeForm,"label-width":"120px"},{default:s(()=>[n(d,{label:"服务器链接状态"},{default:s(()=>[n(c,{modelValue:o.homeForm.connectionStatus,"onUpdate:modelValue":e[0]||(e[0]=h=>o.homeForm.connectionStatus=h),"active-color":"#13ce66","inactive-color":"#ff4949",disabled:"disabled"},null,8,["modelValue"]),n(r,{onClick:l.testConnection},{default:s(()=>[g("测试连接")]),_:1},8,["onClick"])]),_:1}),o.homeForm.connectionStatus?(m(),_(d,{key:0,label:"锁状态"},{default:s(()=>[n(c,{modelValue:o.homeForm.lockState,"onUpdate:modelValue":e[1]||(e[1]=h=>o.homeForm.lockState=h),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:l.onChange},null,8,["modelValue","onChange"])]),_:1})):p("",!0)]),_:1},8,["model"])])}const C=k(W,[["render",H]]);const O={name:"AppIndex",components:{Home:C,Manager:b},data(){return{homeForm:{connectionStatus:!1,lockState:!1},activeIndex:"1",tableData:[{user:"王小虎"},{user:"王小虎"}],hostAddress:"",keyId:"123123"}},mounted(){this.$refs.box.addEventListener("deviceready",()=>{this.onDeviceReady()}),this.getConnectionStatus()},created(){},methods:{testConnection(){this.getConnectionStatus()},onDeviceReady(){this.$refs.box.addEventListener("online",()=>{this.getConnectionStatus()})},handleSelect(t,e){this.activeIndex=t},connectionTest(){u.get("http://"+this.hostAddress+"/inline").then(t=>{t&&t.data==="works"?(this.homeForm.connectionStatus=!0,this.getLockState()):this.homeForm.connectionStatus=!1},t=>{this.homeForm.connectionStatus=!1})},getUserList(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/getAiImage",t).then(e=>{console.log(e)})},getLockState(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/getAiImage",t).then(e=>{console.log(e),alert("获取锁状态"+JSON.stringify(e)),e&&e.data?this.homeForm.lockState=!0:this.homeForm.lockState=!1})},getConnectionStatus(){this.isConnectWifi()},isConnectWifi(){navigator.connection.type===Connection.WIFI?networkinterface.getWiFiIPAddress(e=>{this.hostAddress=this.getNetAddress(e.ip,e.subnet),this.connectionTest()}):alert("请连接WIFI")},getNetAddress(t,e){let o="",i=t.split("."),a=e.split("."),l=Number(i[2]),c=Number(i[3]),r=Number(a[2]),d=Number(a[3]);return o=(l&r)+"."+((c&d)+1),o=i[0]+"."+i[1]+"."+o,o},doOpen(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/open",t).then(e=>{e&&e.data==="open"&&(this.homeForm.lockState=!0)})},doClose(){let t={key:this.keyId};u.post("http://"+this.hostAddress+"/close",t).then(e=>{e&&e.data==="close"&&(this.homeForm.lockState=!1)})},onChangeSwitch(t){t?this.doOpen():this.doClose()}},watch:{activeIndex(t,e){}}},P={ref:"box"};function U(t,e,o,i,a,l){const c=N,r=V,d=B,f=C,h=b,F=D,x=T;return m(),S("div",P,[n(x,null,{default:s(()=>[n(d,null,{default:s(()=>[n(r,{"default-active":a.activeIndex,class:"el-menu-demo",mode:"horizontal",onSelect:l.handleSelect,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},{default:s(()=>[n(c,{index:"1"},{default:s(()=>[g("我的家")]),_:1}),a.homeForm.connectionStatus?(m(),_(c,{key:0,index:"2"},{default:s(()=>[g("管理员页面")]),_:1})):p("",!0)]),_:1},8,["default-active","onSelect"])]),_:1}),n(F,null,{default:s(()=>[a.activeIndex==="1"?(m(),_(f,{key:0,homeForm:a.homeForm,onChangeSwitch:l.onChangeSwitch,onTestButton:l.testConnection},null,8,["homeForm","onChangeSwitch","onTestButton"])):p("",!0),a.activeIndex==="2"?(m(),_(h,{key:1,tableData:a.tableData},null,8,["tableData"])):p("",!0)]),_:1})]),_:1})],512)}const R=k(O,[["render",U]]);export{R as default};
