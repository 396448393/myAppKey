import{_ as S,o as d,c as b,a as o,w as a,E as I,b as v,d as g,e as _,f as p,g as F,h as A,i as w,j as E,k as u,l as N,m as T,n as V,p as B,q as D}from"./index-1cb0bce1.js";const M={name:"Manager",props:{userId:String,tableData:Array},data(){return{}},methods:{}};function O(e,t,n,i,s,l){const c=I,r=v;return d(),b("div",null,[o(r,{data:n.tableData,style:{width:"100%"}},{default:a(()=>[o(c,{prop:"user",label:"用户",width:"180"})]),_:1},8,["data"])])}const k=S(M,[["render",O]]);const L={name:"Home",props:{userId:String,homeForm:Object},data(){return{}},methods:{onChange(e){this.$emit("changeSwitch",e)},testConnection(){this.$emit("testButton")}}};function W(e,t,n,i,s,l){const c=F,r=A,m=w,f=E;return d(),b("div",null,[o(f,{ref:"homeForm",model:n.homeForm,"label-width":"120px"},{default:a(()=>[o(m,{label:"服务器链接状态"},{default:a(()=>[o(c,{modelValue:n.homeForm.connectionStatus,"onUpdate:modelValue":t[0]||(t[0]=h=>n.homeForm.connectionStatus=h),"active-color":"#13ce66","inactive-color":"#ff4949",disabled:"disabled"},null,8,["modelValue"]),o(r,{onClick:l.testConnection},{default:a(()=>[g("测试连接")]),_:1},8,["onClick"])]),_:1}),n.homeForm.connectionStatus?(d(),_(m,{key:0,label:"锁状态"},{default:a(()=>[o(c,{modelValue:n.homeForm.lockState,"onUpdate:modelValue":t[1]||(t[1]=h=>n.homeForm.lockState=h),"active-color":"#13ce66","inactive-color":"#ff4949",onChange:l.onChange},null,8,["modelValue","onChange"])]),_:1})):p("",!0)]),_:1},8,["model"])])}const C=S(L,[["render",W]]);const H={name:"AppIndex",components:{Home:C,Manager:k},data(){return{homeForm:{connectionStatus:!1,lockState:!1},activeIndex:"1",tableData:[{user:"王小虎"},{user:"王小虎"}],hostAddress:"",keyId:"123123"}},mounted(){this.$refs.box.addEventListener("deviceready",()=>{this.onDeviceReady()}),this.getConnectionStatus()},created(){},methods:{testConnection(){this.getConnectionStatus()},onDeviceReady(){this.$refs.box.addEventListener("online",()=>{this.getConnectionStatus()})},handleSelect(e,t){this.activeIndex=e},connectionTest(){u.get("http://"+this.hostAddress+"/inline").then(e=>{alert("通信测试"+JSON.stringify(e)),this.homeForm.connectionStatus=!0},e=>{this.homeForm.connectionStatus=!1})},getUserList(){let e={key:this.keyId};u.post("http://"+this.hostAddress+"/getAiImage",e).then(t=>{console.log(t)})},getLockState(){let e={key:this.keyId};u.post("http://"+this.hostAddress+"/getAiImage",e).then(t=>{console.log(t),alert("获取锁状态"+JSON.stringify(t))})},getConnectionStatus(){this.isConnectWifi()},isConnectWifi(){navigator.connection.type===Connection.WIFI?networkinterface.getWiFiIPAddress(t=>{this.hostAddress=this.getNetAddress(t.ip,t.subnet),this.connectionTest()}):alert("请连接WIFI")},getNetAddress(e,t){let n="",i=e.split("."),s=t.split("."),l=Number(i[2]),c=Number(i[3]),r=Number(s[2]),m=Number(s[3]);return n=(l&r)+"."+((c&m)+1),n=i[0]+"."+i[1]+"."+n,n},doOpen(){let e={key:this.keyId};u.post("http://"+this.hostAddress+"/open",e).then(t=>{console.log(t),alert("开："+JSON.stringify(t)),this.getLockState()})},doClose(){let e={key:this.keyId};u.post("http://"+this.hostAddress+"/close",e).then(t=>{console.log(t),alert("关："+JSON.stringify(t)),this.getLockState()})},onChangeSwitch(e){alert("更改状态："+e),e?this.doClose():this.doOpen()}},watch:{activeIndex(e,t){}}},J={ref:"box"};function P(e,t,n,i,s,l){const c=T,r=V,m=B,f=C,h=k,y=D,x=N;return d(),b("div",J,[o(x,null,{default:a(()=>[o(m,null,{default:a(()=>[o(r,{"default-active":s.activeIndex,class:"el-menu-demo",mode:"horizontal",onSelect:l.handleSelect,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},{default:a(()=>[o(c,{index:"1"},{default:a(()=>[g("我的家")]),_:1}),s.homeForm.connectionStatus?(d(),_(c,{key:0,index:"2"},{default:a(()=>[g("管理员页面")]),_:1})):p("",!0)]),_:1},8,["default-active","onSelect"])]),_:1}),o(y,null,{default:a(()=>[s.activeIndex==="1"?(d(),_(f,{key:0,homeForm:s.homeForm,onChangeSwitch:l.onChangeSwitch,onTestButton:l.testConnection},null,8,["homeForm","onChangeSwitch","onTestButton"])):p("",!0),s.activeIndex==="2"?(d(),_(h,{key:1,tableData:s.tableData},null,8,["tableData"])):p("",!0)]),_:1})]),_:1})],512)}const j=S(H,[["render",P]]);export{j as default};
